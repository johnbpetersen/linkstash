# ADR-002: Store Metadata as Array in links.json, Not Object Map

**Status:** Accepted
**Date:** 2026-02-03

## Context

LinkStash needs to store link metadata persistently. The frontend needs to:
- Display all links sorted by date (newest first)
- Search across all links

We must decide whether to store links as an array of objects or as an object map (keyed by URL or ID).

## Decision

Store as a **JSON array of link objects**:

```json
[
  { "id": "uuid", "url": "...", "title": "...", "added": "2026-02-03T10:00:00Z", ... },
  { "id": "uuid", "url": "...", "title": "...", "added": "2026-02-03T09:00:00Z", ... }
]
```

## Alternatives Considered

1. **Object map keyed by URL**: `{ "https://example.com": {...}, ... }`
   - Pro: O(1) duplicate detection
   - Con: Harder to sort by date, harder to iterate for search, JSON key ordering not guaranteed

2. **Array of objects**: (CHOSEN)
   - Pro: Natural insertion order, easy to sort, easy to search all items
   - Con: Duplicate detection is O(n), but acceptable for ~1000 items

## Consequences

- ✅ Natural insertion order preserved in JSON
- ✅ Easy to sort newest-first on frontend (sort by `added` field)
- ✅ Simple to iterate for search
- ✅ Simple append-only writing from processor
- ❌ Duplicate detection is O(n) — must scan entire array
- ⚠️ At 10,000+ items, may want to switch to Set-based deduplication (future optimization)

## Notes

For v1 (~1000 items), O(n) duplicate detection is acceptable. Frontend and processor both use simple array operations.
